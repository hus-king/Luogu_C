# 模板展开
## 题目描述

模板语言涉及到的数据是字符串。我们约定，字符串是由零个或多个小写字母和数字（`[a-z0-9]`）组成的序列。模板语言中的变量的名称是非空字符串，且变量的值也是字符串。在模板开始执行前，所有变量的值都是空字符串。

### 表达式定义
模板语言中的表达式涉及对变量的值和字符串进行拼接操作。表达式由空格分隔的若干个操作数组成，操作数可以是变量或非空字符串：
- 如果操作数的第一个字符是美元符号（`$`），则表示该操作数是一个变量，操作数的剩余部分为该变量的名称；
- 否则，表示该操作数是一个字符串。

表达式的值是指先将表达式中的所有变量替换为其值，然后将所有操作数拼接在一起得到的字符串。

**示例：**
假设变量 `a` 的值为 `hello`，变量 `b` 的值为 `world`，则：
- 表达式 `a` 的值为 `a`；
- 表达式 `$a` 的值为 `hello`；
- 表达式 `a b` 的值为 `ab`；
- 表达式 `$a b` 的值为 `hellob`；
- 表达式 `$a $b` 的值为 `helloworld`；
- 表达式 `$a $b a` 的值为 `helloworlda`。

### 模板语言语句
模板语言由一系列语句组成，每个语句占一行，每个语句按顺序执行。语句分为两类：赋值语句和输出语句。

#### 赋值语句
赋值语句用于将变量和表达式关联起来，分为两种类型：
1. **直接赋值语句**  
   形式为空格分隔的数字 `1`、变量名称和表达式，形如 `1 <var> <expr>`，表示求表达式的值并将该值作为变量的值。
   - 示例：语句 `1 c $a $b` 执行后，变量 `c` 的值为 `helloworld`。

2. **间接赋值语句**  
   形式为空格分隔的数字 `2`、变量名称和表达式，形如 `2 <var> <expr>`，表示暂时不求表达式的值，而是将该表达式与变量相对应。待到后续求其他表达式的值需要用到该变量时，再求该变量对应的表达式的值并将该值作为变量的值用于求所求的表达式的值。
   - 示例：
     ```plaintext
     2 c $a $b
     1 d good $c
     ```
     在执行第三个语句 `2 c $a $b` 时，变量 `c` 与表达式 `$a $b` 对应起来，但并不求表达式的值。在执行第四个语句 `1 d good $c` 时，需要求表达式 `good $c` 的值，并将该值作为变量 `d` 的值。此时需要用到变量 `c`，因此需要先求表达式 `$a $b` 的值，即 `helloworld`，然后再和 `good` 拼接得到 `goodhelloworld`。因此，执行完第四个语句后，变量 `d` 的值为 `goodhelloworld`。

#### 输出语句
输出语句的形式为空格分隔的数字 `3` 和变量名称，形如 `3 <var>`，表示输出一行，内容为变量的值的长度除以 $10^9 + 7$ 的余数。

**示例：**
```plaintext
3 d
```
表示输出变量 `d` 的值的长度。

---

### 输入格式
从标准输入读入数据：
- 第一行为一个整数 $n$，表示模板语言的语句数量。
- 接下来的 $n$ 行，每行为一个语句，语句的格式如上所述。

### 输出格式
输出到标准输出：
依次执行输入的语句：如果语句为输出语句，则相应输出一行变量的值的长度除以 $10^9 + 7$ 的余数。

---

### 样例输入 1
```plaintext
6
1 a hello
1 b world
2 c $a $b
3 c
1 a hi
3 c
```

### 样例输出 1
```plaintext
10
7
```

### 样例解释 1
本样例即为题目描述中的例子。

---

### 样例输入 2
```plaintext
5
1 var value
3 var
3 val
1 var $var $val $var
3 var
```

### 样例输出 2
```plaintext
5
0
10
```

### 样例解释 2
执行第一条语句后，变量 `var` 的值为 `value`，因此第二条语句输出 `5`；执行第三条语句时，变量 `val` 并未被赋值，因此其值为初始的空字符串，输出 `0`；执行第四条语句后，变量 `var` 的值为 `valuevalue`，因此第五条语句输出 `10`。

---

### 子任务
| 测试点 | $n$ | 语句类型 | 表达式的性质 |
|--------|------|----------|--------------|
| 1, 2   | $\leq 200$ | 无间接赋值语句 | 每个表达式仅有 1 个字符串操作数 |
| 3, 4   | $\leq 200$ | 无间接赋值语句 | 每个表达式仅有 1 个操作数 |
| 5, 6   | $\leq 200$ | 无间接赋值语句 | 每个表达式包含不超过 100 个操作数 |
| 7, 8   | $\leq 200$ | 包含所有类型语句 | 每个表达式包含不超过 100 个操作数 |
| 9, 10  | $\leq 2000$ | 包含所有类型语句 | 每个表达式包含不超过 100 个操作数 |

全部的数据满足：变量的总数不超过 $1000$ 个，且每个变量的名称、字符串的长度不超过 $50$ 个字符。

---

### BNF 定义
模板语言用 BNF 表示如下：
```plaintext
CHAR ::= [a-z0-9]
SPACE ::= ' '
DOLLAR ::= '$'
NONEMPTY_STRING ::= CHAR | NONEMPTY_STRING CHAR
STRING ::= '' | NONEMPTY_STRING
VAR ::= NONEMPTY_STRING
OPERAND ::= DOLLAR VAR | NONEMPTY_STRING
EXPR ::= OPERAND | EXPR SPACE OPERAND
ASSIGN_OP ::= '1' | '2'
ASSIGN ::= ASSIGN_OP SPACE VAR SPACE EXPR
OUTPUT ::= '3' SPACE VAR
STATEMENT ::= ASSIGN | OUTPUT
```